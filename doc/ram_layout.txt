# This list is highly incomplete, and primarily included to
# have all known RAM addresses in one place.

# byte = 1 byte
# word = 2 bytes
# long = 4 bytes

FF0000 FF0280	Sprite_Table: $280 bytes, 8 bytes per sprite ($50 sprites)
FF0280 FF0500   ?
FF0500 ?        DMA queue?
?      FF0DA0	?
FF0DA0 FF2448	Object RAM: $74 bytes per object, $32 slots.
FF2448 FF3B24	GfxObject RAM: $16DC bytes, $4C bytes per object ($4D objects)
FF3B24 ?        Block list.
?      FF4A00   ?
FF4A00 FF4E58	?
FF4E58 FF4ED8	Palette_Buffer: $80 bytes
FF4ED8 FF4FD8	more palette buffers?
FF4FD8 FF503A	?
FF503A FF52C2	Block_Mappings: $288 bytes
FF52C2 FF7392	Level foreground layout: $20D0 bytes. 1 byte per entry (30 screens of $118 entries each)
FF7392 FF7432	Horizontal scrolling related data
FF7432 FF77B2	Horizontal Scroll Buffer: $380 bytes. a.k.a. deformation array
FF77B2 FF87B2   decompression buffer
FF87B2 FF9CB2   background buffer
FF9CB2 FFA652   ?
FFA652 FFE7F2	Level_Layout: $41A0 bytes. 2 bytes per entry: block,skin (30 screens of $118 entries each)
FFE7F2 ?		Object RAM?: ($13 objects), $E bytes per object
FFE90A ?        Object RAM?: ($13 objects), $C bytes per object
FFE9FA ?        Shooter Block Bullet RAM: ($27 objects), $C bytes per object
FFEBDA ?        Object RAM?: ($27 objects), $C bytes per object
FFEDBA ?        Platform RAM?: ($11 objects), $22 bytes per object
FFF01E ?        
FFF2B0 ?        Object RAM?
?      FFF8FE   Misc variables
FFF8FE ?        Enemy status table, one word entry per enemy in enemy layout (whether it's loaded or something)
?      FFFFFF	Misc variables

# To be merged with the above table:
FF7D8E	Some Palette Buffer	(0x40 bytes)
FF87B2  BG tile layout buffer (bytes or plane map depending on $FFFFFB48)
FF8EB2  BG tile layout buffer (plane map) 
FF95B2  BG tile layout buffer (plane map)
FF98F2  BG tile layout buffer (plane map) for hail


# Miscellaneous variables
FFF5BE	word	Diamond power timer
FFF806	word	V-Int counter (number of frames since start of game)
FFF80A	byte	Indicator that V-Int has occurred (flag)
FFF80C	byte	Ctrl_1	# Bitmask for controller buttons: SACBRLDU
FFF80D	byte	Ctrl_1_Held (currently held down)
FFF80E	byte	Ctrl_1_Pressed (newly pressed this frame)
FFF80F	byte	Ctrl_2
FFF810	byte	Ctrl_2_Held
FFF811	byte	Ctrl_2_Pressed
FFF812	byte	Ctrl_Held	# depending on input mode (i.e. currently active player?):
FFF813	byte	Ctrl_Pressed # depending on input mode (i.e. currently active player?):
FFF81C	long	X camera position (16.16 fixed point)
FFF820	long	Y camera position (16.16 fixed point)
FFF824	long	X camera background position? (16.16 fixed point)
FFF828	long	Y camera background position? (16.16 fixed point)
FFF832  long    Address of next available slot in Sprite_Table
FFF836  byte    Number of sprites in Sprite_Table
FFF83E  long    Address of next available Object slot
FFF842  long    Address of first Object in Object_RAM
FFF846  long    Address of currently executed Object
FFF84A  word    Number of Objects
FFF854  long    Address of next available GfxObject slot
FFF858  long    Address of first GfxObject in GfxObject_RAM
FFF85C  word    Number of GfxObjects
FFF85E  long    Pointer to GfxObject that belongs to the kid
FFF890  byte    flag indicating palette has changed
FFF89E  word    width in 16x16 blocks
FFF89C  word    width in 8x8 tiles
FFF89A  word    width in pixels
FFF8A0  word    height in pixels
FFF8A2  word    height in 8x8 tiles
FFF8A4  word    height in 16x16 blocks
FFF8A6  word    background width
FFF8A8  word    background height
FFF8AA  word    Foreground theme
FFF8AA  word    Theme music
FFF8AC  word    Background theme
FFF8AC  word    Theme background
FFF8AE  long    Address of theme mappings
FFF8BA  word    maximal camera X position (width in pixels - $140)
FFF8BC  word    maximal camera Y position (height in pixels - $E0)
FFF8D4  long    pointer to block list?
FFFA6D  byte    flag whether kid is currently transforming
FFFA70  word    Telepad timer
FFFA7A  word    Kid hitbox left
FFFA7C  word    Kid hitbox right
FFFA7E  word    Kid hitbox top
FFFA80  word    Kid hitbox bottom
FFFA88  long    Pointer to current platform layout
FFFA8C  word    Offset to platform in current platform layout
FFFA8E  word    Pointer to first element in platform list
FFFA90  word    Pointer to next free slot in platform list
FFFA92  word    Number of platforms currently loaded
FFFA8C  word    Offset in current platform layout that the platform loading manager will process next
FFFA94  word    Pointer to platform kid is currently on
FFFAC1	byte	Murder wall flag:	-1 = Murder wall, 0 = None
FFFAC2	byte	Murder wall flag if both bits of the 3rd entry of maphdr are set?
FFFAC8	long	Murder wall speed
FFFACC	long	Murder wall terminal speed
FFFAD1	byte	selected option in Pause menu: 0=continue, 1=restart/give up
FFFAD2	byte	flags from top 2 bits of map header y position, times 2 -- this is a width in blocks added to the next 4 variables (scaled accordingly)?
FFFAD6  word    timer for storm background (counts down from 4, and if 0, display rain background)
FFFB40	word	Level Special Effects: 0 = None, 1 = Lava Geyser, 2 = Storm, 3 = Storm+Hail, >=4 = Invalid
FFFB48	byte	background format (flag): 0 = pieces, -1 = enigma. (only depends on bg theme)
FFFBC4	word	Pointer to current Keypress in Demo
FFFBC9  byte    Demo Mode flag (for input)
FFFBCA  word    Game Mode:
    00 - SegaScreen
    04 - IntroSequence1
    08 - TitleCard
    0C - InGame        ; also Results screen
    10 - DemoPlay
    14 - OptionMenu
    18 - IntroSequence2
    1C - IntroSequence3
    20 - IntroSequence4
    24 - IntroSequence5
    28 - IntroSequence6 ; is also TitleScreen if intro played completely
    2C - TitleScreen
    30 - EndSequence
FFFBD4  long    address of map header
FFFC18	word	Lives displayed on counter
FFFC1A	word	number of diamonds from previous frame (displayed on counter?)
FFFC1C	word	Time: Frames
FFFC1E	word	Time: Seconds (1st digit)
FFFC20	word	Time: Seconds (2nd digit)
FFFC22	word	Time: Minutes
FFFC2A	word	player x start position
FFFC2C	word	player y start position
FFFC2E	word	flag x position
FFFC30	word	flag y position
FFFC38	word	two player flag ?
FFFC3B	byte	No Hit Bonus: 0 = retained, -1 = lost
FFFC3C	byte	No Prize Bonus: 0 = retained, -1 = lost
FFFC3D	byte	Level completion time (seconds)
FFFC3E	word 	number of lives
FFFC40	word	Number of hit-points filled
FFFC42	word 	Number of Diamonds
FFFC44	word	Current LevelID
FFFC46	word 	Costume/helmet
	00 - None
	01 - Skycutter
	02 - Cyclone
	03 - Red Stealth
	04 - Eyeclops
	05 - Juggernaut
	06 - Iron Knight
	07 - Berzerker
	08 - Maniaxe
	09 - Micromax
FFFC48	word	Number of continues
FFFC4A	word	Extra hit point slots
FFFC4C	long	Score
FFFC54	word	Player 1 - Lives
FFFC56	word	Player 1 - Hit points
FFFC58	word	Player 1 - Diamonds
FFFC5A	word	Player 1 - Level number
FFFC5C	word	Player 1 - Transformation number
FFFC5E	word	Player 1 - Continues
FFFC60	word	Player 1 - Extra hit point slots
FFFC62	long	Player 1 - Score
FFFC6A	word	Player 2 - Lives
FFFC6C	word	Player 2 - Hit points
FFFC6E	word	Player 2 - Diamonds
FFFC70	word	Player 2 - Level number
FFFC72	word	Player 2 - Transformation number
FFFC74	word	Player 2 - Continues
FFFC76	word	Player 2 - Extra hit point slots
FFFC78	long	Player 2 - Score
FFFDC8	byte	selected sub-option 1 in options menu (flag). 2 Players: One controller = 0, Two = -1
FFFDC9	byte	selected sub-option 3 in options menu (flag). Speed: Normal = 0, Fast = -1
FFFDCA	word	selected sub-option 2 in options menu: Controls (0-5)
FFFDCC	word	Options menu selection
FFFDCC	word	selected option in options menu
FFFDCE	word	Clocks collected in level
!FFFDC6	byte	HACK: used for level select
!FFFDC7	byte	HACK: used as level select flag
FF0DB8	word	Menu timer
FF0DBD	byte	main menu option
FF0DC1	byte	main menu option * 2
FF2596	word	main menu option selector Y position

# unsure about these:
FF0DB8    Menu timer    ; word
FF0DBD    main menu option  ; byte
FF0DC1    main menu option * 2  ; byte
FF2596    main menu option selector Y position  ; word
?FFFAD2    flags from top 2 bits of map header y position, times 2 -- this is a width in blocks added to the next 4 variables (scaled accordingly)?  ; byte
    and in fact seems to be added to any kind of object


Palette_Buffer ($FFFF4E58):
- is transferred to CRAM via DMA


Sprite Table ($FFFF0000), $280 bytes, 8 bytes per sprite
- is transferred to VRAM via DMA
- The first few slots seems to fixed for various HUD elements:
 0:  Ankh
 8:  first digit of number of lives
10:  second digit of number of lives, or x
18:  Minutes
20:  colon
28:  Seconds, upper digit
30:  Seconds, lower digit
38:  diamond
40:  first digit of number of diamonds
48:  second digit of number of diamonds, or x
The slots after 50 are allocated dynamically, first the
hitpoint display, then kid sprites, then other objects.


Object RAM
----------

Objects and GfxObjects are organized in a linked list. There are
a few more RAM sections organized like linked lists, e.g. for 
platforms or bullets shot from shooter blocks.

Each object entry starts with a pointer to its successor, or a NULL
pointer in case it's the last object in the list. For both the
Object and GfxObject list, there are RAM addresses containing
(1) pointer to the first element in the list
(2) pointer to the next empty object slot in RAM
(3) the current number of objects in the list

For both object lists, there are functions for
(1) initializing the list
(2) allocating a slot for use and returning its address
(3) deleting an element from the list

The Object RAM at FF0DA0 consists of $32 slots, $74 bytes per object.
Each object has a pointer to its code at offset 4. Once per frame,
the game goes through the list of objects and for each object executes
that code. Before executing the code, the values stored at offsets 
$16 to $36 are unpacked into the registers d0-d3 and a0-a3 (in that
order). Executing of object code stops when the object deletes itself,
or hibernates. Upon hibernation, the objects stores the register values
d0-d3 and a0-a3 at offset $16 to $36 again, and will resume at the
position in the code after the call to the hibernation function in the
next frame (or after a larger amount of frames if a hibernation duration
was provided). There is also a RAM address with a pointer of to the
object that is currently being executed.

Most or all object also have one or multiple GfxObjects associated
to them. The GfxObject RAM at FF2448 consists of $4D slots, $4C bytes per 
object. These contain data such as position/velocity of the object and 
animation data. Each frame, the game goes through all GfxObjects and
adds velocity to position, computes the animation, computes collision
with the level and the kid and possibly more stuff. The game also
compiles each GfxObject into a Sprite_Table entry which are then transferred
to VRAM to be displayed. There are also RAM addresses
FFF866
FFF86A
FFF86E
FFF872
whose purpose is currently unknown.


Object format for objects from Object RAM at FF0DA0:
 0: (long) pointer to next object in list (0 if it's the last object)
 4: (long) pointer to object code
 8: (word) object hibernation counter
 A: (long) pointer to some GfxObject?
 E: ?
10: (byte) flag
11: ?
12: (long)
16: (8*long) values unpacked into d0-d3 and a0-a3
36: (long) pointer to GfxObject in FF2448
3A: (long) pointer to subobject in FF2448?
3E: (long) pointer to subobject in FF2448?
42: (byte) lower 6 bits: index in Enemy status table; bits 6&7: unknown flags.
43: ?
44: (long) (for enemies) address in enemy layout. (for platforms) corresponding platform object
44-74: ?


Object format for GfxObject from GfxObject RAM at FF2448:
 0: (long) pointer to next objectData
 4: (long) ???address to some kind of gfxobject slot
 8: (word) ???lower word from value of a3 at allocation call; related to FFF866 etc
 A: (word) ?upper word from value of a3 at allocation call -- priority?
 C: (long) address of corresponding object (a5)
10: (byte)
11: (byte)
12: (byte)
13: (byte) flag
14: (byte) flag: whether to move object (i.e. add vel to pos)
15: (byte) flag: whether to animate object
16: (byte) flag: horizontal direction
17: (byte)
18: (byte) flag
19: (byte) flag
1A: (long) X position (16.16 fixed point)
1E: (long) Y position (16.16 fixed point)
22: (word) offset from DataIndex to current sprite (to be displayed)
24: (word)
26: (long) X velocity (16.16 fixed point)
2A: (long) Y velocity (16.16 fixed point)
2E: (long) pointer to current anim_frame
32: (word) animation frame duration countdown?
34: ?
38: (word) level collision event ID
3A: (word)
3C: (byte) flag: whether to execute level collision?
3D: (byte) flag
3E: (long) some x position relative to camera?
42: (long) some y position relative to camera?
46: ?
48: (word)
4A: (word)

The Kid is part of the GfxObject RAM and starts at $FF24E0.
In particular, we have the following RAM addresses:
FF24FA  long    Kid X position (16.16 fixed point)
FF24FE  long    Kid Y position (16.16 fixed point)
FF2506  long    Kid X speed
FF250A  long    Kid Y speed


Object format for Platform Objects from Platform RAM at FFEDBA:
 0: (word) pointer to next in list
 2: (long) x position
 6: (long) y position
 A: (long) x velocity
 E: (long) y velocity
12: (long) scripted: address of current position in platform preset; special: (byte/flag) whether to delete?
16: (word) scripted: duration countdown; special: word from word_282E depending on s bits
18: (word) art address in VRAM
1A: (word) horizontal size in pixels
1C: (word) vertical size in pixels
1E: ?
1F: (byte) 8ths byte from platform layout definition (ts bits)
20: (word) Offset to platform in current platform layout


Block List
----------

Starts at FF3B24

One entry per block. 3 words header, plus data dependent on block type.
Header:
0  pointer to corresponding block in Level_Layout RAM
2  ?
4  block type
6  data dependent on block type

type dependent data:
Prize block: 
1 word:  prize ID

Ghost block:
5 words:  ?, ?, ?, ?, ?